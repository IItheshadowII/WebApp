*** Begin Patch
*** Update File: src/app/api/transactions/route.ts
@@
-import { NextRequest, NextResponse } from "next/server";
-import prisma from "@/lib/prisma";
-
-// Simplificamos: el endpoint ya no requiere autenticación para leer transacciones.
-export async function POST(req: NextRequest) {
-    const data = await req.json();
-
-    const transaction = await prisma.transaction.create({
-        data: {
-            ...data,
-            // Si no se provee userId, Prisma fallará; se asume que el frontend envía uno válido.
-            date: new Date(),
-        },
-    });
-
-    return NextResponse.json(transaction);
-}
-
-export async function GET(req: NextRequest) {
-    const transactions = await prisma.transaction.findMany({
-        orderBy: { date: 'desc' },
-    });
-
-    return NextResponse.json(transactions);
-}
+import { NextRequest, NextResponse } from "next/server";
+import { auth } from "@/auth";
+import prisma from "@/lib/prisma";
+
+export async function POST(req: NextRequest) {
+    const session = await auth();
+    if (!session?.user?.id) return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })
+
+    const data = await req.json().catch(() => ({}));
+
+    const transaction = await prisma.transaction.create({
+        data: {
+            ...data,
+            userId: session.user.id,
+            date: new Date(),
+        },
+    });
+
+    return NextResponse.json(transaction);
+}
+
+export async function GET(req: NextRequest) {
+    const session = await auth();
+    if (!session?.user?.id) return NextResponse.json([], { status: 200 })
+
+    const transactions = await prisma.transaction.findMany({
+        where: { userId: session.user.id },
+        orderBy: { date: 'desc' },
+    });
+
+    return NextResponse.json(transactions);
+}
*** End Patch
